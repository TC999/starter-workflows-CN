# æ­¤å·¥ä½œæµä½¿ç”¨æœªç» GitHub è®¤è¯çš„æ“ä½œã€‚
# å®ƒä»¬ç”±ç¬¬ä¸‰æ–¹æä¾›ï¼Œå¹¶å—å•ç‹¬çš„æœåŠ¡æ¡æ¬¾ã€éšç§æ”¿ç­–å’Œæ”¯æŒæ–‡æ¡£çº¦æŸã€‚
#
# è¿è¡Œ Nexploit æ‰«æ
# æ­¤æ“ä½œåœ¨ Nexploit ä¸­è¿è¡Œæ–°çš„å®‰å…¨æ‰«æï¼Œæˆ–é‡æ–°è¿è¡Œç°æœ‰æ‰«æã€‚
# æ„å»ºå®‰å…¨çš„åº”ç”¨ç¨‹åºå’Œ APIã€‚å¿«é€Ÿã€‚
# [NeuraLegion](https://www.neuralegion.com) æ˜¯ä¸€æ¬¾å¼ºå¤§çš„åŠ¨æ€åº”ç”¨ç¨‹åºå’Œ API å®‰å…¨æµ‹è¯•ï¼ˆDASTï¼‰å¹³å°ï¼Œå—åˆ°å®‰å…¨å›¢é˜Ÿçš„ä¿¡ä»»ï¼Œä¹Ÿå—åˆ°å¼€å‘äººå‘˜çš„å–œçˆ±ã€‚
# è‡ªåŠ¨æµ‹è¯•åº”ç”¨ç¨‹åºå’Œ API çš„æ¯ä¸ªæ–¹é¢
# æ‰«æä»»ä½•ç›®æ ‡ï¼Œæ— è®ºæ˜¯ Web åº”ç”¨ç¨‹åºã€APIï¼ˆRESTã€SOAPã€GraphQL ç­‰ï¼‰ã€Web sockets è¿˜æ˜¯ç§»åŠ¨åº”ç”¨ç¨‹åºï¼Œæä¾›å¯æ“ä½œçš„æŠ¥å‘Š
# ä¸æ‚¨å·²ç»ä½¿ç”¨çš„å·¥å…·å’Œå·¥ä½œæµç¨‹æ— ç¼é›†æˆ
#
# NeuraLegion ä¸ç°æœ‰çš„ CI/CD æµæ°´çº¿ä¸€èµ·å·¥ä½œ - åœ¨æ¯æ¬¡æäº¤ã€æ‹‰å–è¯·æ±‚æˆ–å¸¦æœ‰å•å…ƒæµ‹è¯•çš„æ„å»ºä¸­è§¦å‘æ‰«æã€‚
# ä½¿ç”¨ä»£ç è½»æ¾å¯åŠ¨ã€é…ç½®å’Œæ§åˆ¶æ‰«æ
# ä¸€ä¸ªæ–‡ä»¶ã€‚ä¸€ä¸ªå‘½ä»¤ã€‚ä¸€ä¸ªæ‰«æã€‚æ— éœ€ UIã€‚
#
# è¶…å¿«é€Ÿæ‰«æ
#
# ä¸å…¶ä»…çˆ¬è¡Œå’ŒçŒœæµ‹ä¸åŒï¼Œä¸åº”ç”¨ç¨‹åºå’Œ API è¿›è¡Œäº¤äº’ã€‚
# ç”±äºæˆ‘ä»¬çš„ AI å¼•æ“å¯ä»¥ç†è§£åº”ç”¨ç¨‹åºæ¶æ„å¹¶ç”Ÿæˆå¤æ‚ä¸”æœ‰é’ˆå¯¹æ€§çš„æ”»å‡»ï¼Œå› æ­¤æ‰«æé€Ÿåº¦å¾ˆå¿«ã€‚
#
# æ— è¯¯æŠ¥
#
# åœæ­¢è¿½é€å¹½çµå’Œæµªè´¹æ—¶é—´ã€‚NeuraLegion ä¸è¿”å›è¯¯æŠ¥ï¼Œå› æ­¤æ‚¨å¯ä»¥ä¸“æ³¨äºå‘å¸ƒä»£ç ã€‚
#
# å…¨é¢çš„å®‰å…¨æµ‹è¯•
#
# NeuraLegion å¯¹æ‰€æœ‰å¸¸è§æ¼æ´è¿›è¡Œæµ‹è¯•ï¼Œå¦‚ SQL æ³¨å…¥ã€CSRFã€XSS å’Œ XXE - ä»¥åŠä¸å¸¸è§çš„æ¼æ´ï¼Œå¦‚ä¸šåŠ¡é€»è¾‘æ¼æ´ã€‚
#
# å¯åœ¨ NeuraLegion çš„ä»¥ä¸‹ä½ç½®è·å–æ›´å¤šä¿¡æ¯ï¼š
# * [å®˜ç½‘](https://www.neuralegion.com/)
# * [çŸ¥è¯†åº“](https://docs.neuralegion.com/docs/quickstart)
# * [YouTube é¢‘é“](https://www.youtube.com/channel/UCoIC0T1pmozq3eKLsUR2uUw)
# * [GitHub Actions](https://github.com/marketplace?query=neuralegion+)
#
# è¾“å…¥
#
# `name`
#
# **å¿…éœ€**ã€‚æ‰«æåç§°ã€‚
#
# _ç¤ºä¾‹:_ `name: GitHub scan ${{ github.sha }}`
#
# `api_token`
#
# **å¿…éœ€**ã€‚æ‚¨çš„ Nexploit API æˆæƒä»¤ç‰Œï¼ˆå¯†é’¥ï¼‰ã€‚æ‚¨å¯ä»¥åœ¨ [nexploit.app](https://nexploit.app/login) çš„ **Organization** éƒ¨åˆ†ç”Ÿæˆå®ƒã€‚åœ¨æ­¤å¤„æ‰¾åˆ°æ›´å¤šä¿¡æ¯ [here](https://kb.neuralegion.com/#/guide/np-web-ui/advanced-set-up/managing-org?id=managing-organization-apicli-authentication-tokens)ã€‚
#
# _ç¤ºä¾‹:_ `api_token: ${{ secrets.NEXPLOIT_TOKEN }}`
#
# `restart_scan`
#
# **å¿…éœ€**ï¼Œå½“é€šè¿‡å…¶ ID é‡æ–°å¯åŠ¨ç°æœ‰æ‰«ææ—¶ã€‚æ‚¨å¯ä»¥åœ¨ [nexploit.app](https://nexploit.app/login) çš„æ‰«æéƒ¨åˆ†è·å–æ‰«æ IDã€‚<br> è¯·ç¡®ä¿ä»…ä½¿ç”¨å¿…è¦çš„å‚æ•°ã€‚å¦åˆ™ï¼Œæ‚¨å°†æ”¶åˆ°å¸¦æœ‰å‚æ•°ä½¿ç”¨è¦æ±‚çš„å“åº”ã€‚
#
# _ç¤ºä¾‹:_ `restart_scan: ai3LG8DmVn9Rn1YeqCNRGQ)`
#
# `discovery_types`
#
# **å¿…éœ€**ã€‚å‘ç°ç±»å‹æ•°ç»„ã€‚ä»¥ä¸‹ç±»å‹å¯ç”¨ï¼š
# * `archive` - ä½¿ç”¨ä¸Šä¼ çš„ HAR æ–‡ä»¶è¿›è¡Œæ‰«æ
# * `crawler` - ä½¿ç”¨çˆ¬è™«å®šä¹‰æ‰«æçš„æ”»å‡»é¢
# * `oas` - ä½¿ç”¨ä¸Šä¼ çš„ OpenAPI æ¨¡å¼è¿›è¡Œæ‰«æ <br>
# å¦‚æœæœªæŒ‡å®šå‘ç°ç±»å‹ï¼Œåˆ™é»˜è®¤åº”ç”¨ `crawler`ã€‚
#
# _ç¤ºä¾‹:_
#
# ```yml
# discovery_types: |
#   [ "crawler", "archive" ]
# ```
#
# `file_id`
#
# **å¿…éœ€**ï¼Œå¦‚æœå‘ç°ç±»å‹è®¾ç½®ä¸º `archive` æˆ– `oas`ã€‚è¦ç”¨äºæ‰«æçš„ HAR æ–‡ä»¶æˆ– OpenAPI æ¨¡å¼çš„ IDã€‚æ‚¨å¯ä»¥åœ¨ [nexploit.app](https://nexploit.app/login) çš„ **Storage** éƒ¨åˆ†ä¸­è·å–å·²ä¸Šä¼ çš„ HAR æ–‡ä»¶æˆ– OpenAPI æ¨¡å¼çš„ IDã€‚
#
# _ç¤ºä¾‹:_
#
# ```
# FILE_ID=$(nexploit-cli archive:upload   \
# --token ${{ secrets.NEXPLOIT_TOKEN }}   \
# --discard true                          \
# ./example.har)
# ```
#
# `crawler_urls`
#
# **å¿…éœ€**ï¼Œå¦‚æœå‘ç°ç±»å‹è®¾ç½®ä¸º `crawler`ã€‚çˆ¬è™«ç”¨äºå®šä¹‰æ”»å‡»é¢çš„ç›®æ ‡ URLã€‚
#
# _ç¤ºä¾‹:_
#
# ```
# crawler_urls: |
#   [ "http://vulnerable-bank.com" ]
# ```
#
# `hosts_filter`
#
# **å¿…éœ€**ï¼Œå½“å‘ç°ç±»å‹è®¾ç½®ä¸º `archive` æ—¶ã€‚å…è®¸é€‰æ‹©æ‰«æçš„ç‰¹å®šä¸»æœºã€‚
#
# è¾“å‡º
#
# `url`
#
# æ‰«æç»“æœçš„ URL
#
# `id`
#
# åˆ›å»ºçš„æ‰«æçš„ IDã€‚ç„¶åå¯ä»¥ä½¿ç”¨æ­¤ ID é‡æ–°å¯åŠ¨æ‰«æï¼Œæˆ–ç”¨äºä»¥ä¸‹ GitHub æ“ä½œï¼š
# * [Nexploit Wait for Issues](https://github.com/marketplace/actions/nexploit-wait-for-issues)
# * [Nexploit Stop Scan](https://github.com/marketplace/actions/nexploit-stop-scan)
#
# ç¤ºä¾‹ç”¨æ³•
#
# å¯åŠ¨å…·æœ‰å‚æ•°çš„æ–°æ‰«æ
#
# ```yml
# steps:
#     - name: å¯åŠ¨ Nexploit æ‰«æ
#       id: start
#       uses: NeuraLegion/run-scan@29ebd17b4fd6292ce7a238a59401668953b37fbe
#       with:
#         api_token: ${{ secrets.NEURALEGION_TOKEN }}
#         name: GitHub scan ${{ github.sha }}
#         discovery_types: |
#           [ "crawler", "archive" ]
#         crawler_urls: |
#           [ "http://vulnerable-bank.com" ]
#         file_id: LiYknMYSdbSZbqgMaC9Sj
#         hosts_filter: |
#           [ ]
#     - name: è·å–è¾“å‡ºæ‰«æ URL
#       run: echo "The scan was started on ${{ steps.start.outputs.url }}"
# ```
#
# é‡æ–°å¯åŠ¨ç°æœ‰æ‰«æ
#
# ```yml
# steps:
#     - name: å¯åŠ¨ Nexploit æ‰«æ
#       id: start
#       uses: NeuraLegion/run-scan@29ebd17b4fd6292ce7a238a59401668953b37fbe
#       with:
#         api_token: ${{ secrets.NEURALEGION_TOKEN }}
#         name: GitHub scan ${{ github.sha }}
#         restart_scan: ai3LG8DmVn9Rn1YeqCNRGQ
#     - name: è·å–è¾“å‡ºæ‰«æ URL
#       run: echo "The scan was started on ${{ steps.start.outputs.url }}"


name: "NeuraLegion"

on:
  push:
    branches: [ $default-branch, $protected-branches ]
  pull_request:
    branches: [ $default-branch ]
  schedule:
    - cron: $cron-weekly

jobs:
  neuralegion_scan:
    runs-on: ubuntu-18.04
    name: è¿è¡Œ Nexploit æ‰«æçš„ä½œä¸š
    steps:
      - uses: actions/checkout@v2
      - name: å¯åŠ¨ Nexploit æ‰«æ ğŸ
        id: start
        uses: NeuraLegion/run-scan@29ebd17b4fd6292ce7a238a59401668953b37fbe
        with:
          api_token: ${{ secrets.NEURALEGION_TOKEN }}
          name: GitHub æ‰«æ ${{ github.sha }}
          discovery_types: |
            [ "crawler" ]
          crawler_urls: |
            [ "https://brokencrystals.com" ] # âœï¸ æ›´æ–°ä¸ºæ‚¨è¦æ‰«æçš„ç½‘å€
